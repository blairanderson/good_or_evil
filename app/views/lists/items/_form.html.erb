<%
   #this FORM is shared for BOTH
   simple_form_url = if list_item.persisted?
                       account_list_item_path(current_account, current_list, list_item)
                     else
                       account_list_items_path(current_account, current_list)
                     end
%>

<% if list_item.persisted? %>
  <div class="cf mt4 mb2">
    <h3 class="di" id="<%= list_item.id %>"><%= list_item.style.to_s.titleize %></h3>
    <%= link_to("Remove", simple_form_url, method: :delete, data: {confirm: "Are You Sure?"}) %>
  </div>
<% end %>

<% if list_item.persisted? && list_item.form_title? %>
  <%= simple_form_for(list_item, url: simple_form_url) do |f| %>
    <%= f.input :title, as: :string, placeholder: "Some Awesome Product title here!" %>
    <%= f.button(:submit, "Update Title") %>
  <% end %>
<% end %>

<% if list_item.sorting_enabled? %>
  <%= link_to("#{up_arrow}move up#{up_arrow}".html_safe, sort_account_list_item_path(current_account.id, current_list.id, list_item.id, pos: :inc), method: :post) %>
  <%= link_to("#{down_arrow}move down#{down_arrow}".html_safe, sort_account_list_item_path(current_account.id, current_list.id, list_item.id, pos: :dec), method: :post) %>
<% end %>

<% if list_item.persisted? && list_item.form_image? %>
  <%= simple_form_for(list_item, url: simple_form_url) do |f| %>
    <%= f.attachment_field :image %>
    <%= image_tag(attachment_url(list_item, :image, format: "png")) %>
    <%= f.button(:submit) %>
  <% end %>
<% end %>



<% if list_item.persisted? && list_item.form_link? %>
  <%= simple_form_for(list_item, url: simple_form_url) do |f| %>
    <%= f.input :affiliate_link, as: :string, placeholder: "your amazon Affiliate link to this product" %>
    <%= f.button(:submit, "Add Link Here!") %>
  <% end %>
<% end %>


<% if list_item.persisted? && list_item.form_ingredients? %>
  <ul>
    <% list_item.list_item_ingredients.where.not(id: nil).each_with_index do |ingredient, index| %>
      <li>
        <details>
          <summary><%= ingredient.name %></summary>
          <%= simple_form_for(ingredient) do |f| %>
            <div class="cf">
              <div class="fl w-50">
                <%= f.input(:name, label: false, placeholder: "1-1/2 Diced Medium Onions") %>
              </div>
              <div class="fl w-40">
                <%= f.button(:submit, "Update") %>
              </div>
            </div>
          <% end %>
        </details>
      </li>
    <% end %>

  </ul>


  <%= simple_form_for(list_item.list_item_ingredients.build(list_item_id: list_item.id)) do |f| %>
    <div class="cf">
      <div class="fl w-40">
        <%= f.input :list_item_id, as: :hidden %>
        <%= f.input(:name, label: false, placeholder: "1-1/2 Diced Medium Onions") %>
      </div>
      <div class="fl w-40">
        <%= f.button(:submit, "Add") %>
      </div>
    </div>
  <% end %>

<% end %>


<% if list_item.persisted? && list_item.form_body? %>
  <%= simple_form_for(list_item, url: simple_form_url) do |f| %>
    <%= f.input :body, as: :hidden, input_html: {id: "list_item_body_#{list_item.id}"} %>
    <trix-editor input="<%= "list_item_body_#{list_item.id}" %>" placeholder="Add a super cool description about why this thing is worth looking at!"></trix-editor>
    <%= f.button(:submit) %>
  <% end %>
<% end %>
